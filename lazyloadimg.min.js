/* 
 * Lazy Loading Images using requestAnimationFrame
 * Based on http://css-tricks.com/snippets/javascript/lazy-loading-images/
 * & http://www.html5rocks.com/en/tutorials/speed/animations/
 * lazyloadimg.js (c) Deb Das
 * MIT License (http://www.opensource.org/licenses/mit-license.html)
 *
 * Expects a list of containers span or div like:  
 * `<span class="lazy" data-img-src="image_src_url"></span>`
 * Class lazy is required
 * rAF polyfil available here: https://gist.github.com/paulirish/1579671
 */(function(e){var t=function(e,t){if(document.querySelectorAll)t=document.querySelectorAll(e);else{var n=document,r=n.styleSheets[0]||n.createStyleSheet();r.addRule(e,"f:b");for(var i=n.all,s=0,o=[],u=i.length;s<u;s++)i[s].currentStyle.f&&o.push(i[s]);r.removeRule(0),t=o}return t},n=function(t,n){e.addEventListener?this.addEventListener(t,n,!1):e.attachEvent?this.attachEvent("on"+t,n):this["on"+t]=n},r=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i=function(e,t,n){var r=new Image,i=e.getAttribute("data-img-src");r.onload=function(r,i){e.appendChild(r.target),n?n(t):null},r.src=i},s=function(t){var n=t.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top<=(e.innerHeight||document.documentElement.clientHeight)},o=new Array,u=t(".lazy"),a=!1,f=function(){a=!0;for(var e=0;e<o.length;e++){var t=o[e].item;s(t)&&!t.loaded&&!t.loading&&(t.loading=!0,console.log("image "+e+" loading"),i(t,e,function(e){console.log("called for image: "+e),o[e].loaded=!0,o[e].loading=!1,console.log("image "+e+" loaded")}))}a=!1},l=function(){c()},c=function(){a||(console.log("rAF called"),requestAnimationFrame(f))};for(var h=0;h<u.length;h++)o.push({item:u[h],loaded:!1,loading:!1});f(),n("scroll",l)})(this);